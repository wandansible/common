---
- name: Converge
  hosts: all
  tasks:
    - name: "Include wandansible.common"
      ansible.builtin.include_role:
        name: "wandansible.common"
      vars:
        locale: "C.UTF-8"
        timezone: "Etc/UTC"

        debian_mirror: "https://mirror.fsmg.org.nz/debian/"
        ubuntu_mirror: "https://mirror.fsmg.org.nz/ubuntu/"

        apt_repos:
          - name: tailscale
            repo: >-
              deb [signed-by=/etc/apt/keyrings/tailscale.gpg]
              https://pkgs.tailscale.com/stable/{{ ansible_distribution | lower }} {{ ansible_distribution_release }} main
            key:
              url: https://pkgs.tailscale.com/stable/{{ ansible_distribution | lower }}/{{ ansible_distribution_release }}.asc
              id: 2596A99EAAB33821893C0A79458CA832957F5868
              keyring: /etc/apt/keyrings/tailscale.gpg

  environment:
    ANSIBLE_UNSAFE_WRITES: "true"
